USE 教務系統
GO
SET TRANSACTION ISOLATION LEVEL REPEATABLE READ
BEGIN TRAN
UPDATE 員工 
SET 薪水 = 65000,
    保險 = 3000
WHERE 身份證字號 = 'Y123456789'
IF @@ERROR = 0
  BEGIN
    UPDATE 教授 
    SET 職稱 = '副教授'
    WHERE 教授編號 = 'I014'
    IF @@ERROR = 0
       COMMIT TRAN
    ELSE
       ROLLBACK TRAN
  END
ELSE
  ROLLBACK TRAN

















